{
    "collab_server" : "",
    "contents" : "doInstall <- TRUE\ntoInstall <- c(\"Hmisc\", \"ggplot2\", \"proxy\", \"grid\")\nif(doInstall){install.packages(toInstall, repos = \"http://cran.us.r-project.org\")}\nlapply(toInstall, library, character.only = TRUE)\n\n# Example usage\nx <- c(4,6,4,5,6,7)\ny <- 1:6\nplot(x, y, \"o\", pch=20)  # bezier() generates smoothed curves from these points\npoints(bezier(x, y), type=\"l\", col=\"red\")\n\n# Randomly-generated curve:\nx <- runif(10)  # The evaluation argument dictates the length of the output\ny <- runif(10)  # vector. For our eventual purposes, it is useful to have a\nplot(x, y, \"o\", pch=20)  # pretty fine-grained vector\npoints(bezier(x, y, evaluation = 500), type=\"l\", col=\"red\")\n\nx = c(1, 1, 1, 10)  # Aiming for something specific here\ny = c(10, 1, 1, 1)  # namely, isoquant lines\nplot(x, y, \"o\", pch=20)\npoints(bezier(x,y,20), type=\"l\", col=\"red\")\npoints(bezier(x+1,y+1), type=\"l\", col=\"red\")\npoints(bezier(x+2,y+2), type=\"l\", col=\"red\")\n\n### Supply and Demand ###\n# Replicating http://en.wikipedia.org/w/index.php?title=File:Supply-demand-right-shift-demand.svg&page=1\nx <- c(1, 8, 9)\ny <- c(1, 5, 9)\nsupply1 <- data.frame(bezier(x, y, evaluation = 500))\nx <- c(1, 3, 9)\ny <- c(9, 3, 1)\ndemand1 <- data.frame(bezier(x, y, evaluation = 500))\ndemand2 <- data.frame(bezier(x+2, y+2, evaluation = 500))\n\n# Helper function to identify approximate curve intersections by brute force\napproxIntersection <- function(path1, path2){\n  distanceMatrix <- proxy::dist(path1, path2)\n  whichMin <- which(distanceMatrix == min(distanceMatrix), arr.ind = TRUE)\n  return((path1[whichMin[1], ]+path2[whichMin[2], ])/2)\n}  # This is where a long bezier() output vector is useful\n\nintersectS1D1 <- approxIntersection(supply1, demand1)\nintersectS1D2 <- approxIntersection(supply1, demand2)\nintersections <- data.frame(rbind(intersectS1D1, intersectS1D2))\n\ntextAnnotations <- data.frame(label = c(\"S\", \"D1\", \"D2\"),\n                              x = c(8, 1, 5),  # DF of line labels\n                              y = c(8, 8, 8))\n\nzp1 <- qplot(x = 0:10, y = 0:10, geom = \"blank\")  # Draw an empty plot\nzp1 <- zp1 + geom_path(data = supply1, aes(x = x, y = y),  # Add supply curve\n                       size = 1, colour = \"BLUE\")\nzp1 <- zp1 + geom_path(data = demand1, aes(x = x, y = y),  # Add demand 1\n                       size = 1, colour = \"RED\")\nzp1 <- zp1 + geom_path(data = demand2, aes(x = x, y = y),  # Add demand 2\n                       size = 1, colour = \"RED\")\nzp1 <- zp1 + geom_point(data = intersections,  # Add points at intersections\n                        aes(x = x, y = y), size = 3)\nzp1 <- zp1 + geom_segment(data = intersections,  # Add dotted lines\n                          aes(x = x, y = 0, xend = x, yend = y),\n                          lty = 2)\nzp1 <- zp1 + geom_segment(data = intersections,  # Add dotted lines\n                          aes(x = 0, y = y, xend = x, yend = y),\n                          lty = 2)\nzp1 <- zp1 + geom_text(data = textAnnotations,  # Add curve labels\n                       aes(x = x, y = y, label = label))\nzp1 <- zp1 + annotate(\"segment\", x = 3.5, xend = 4.5, y = 6, yend = 7,  # Arrow\n                      arrow = arrow(length = unit(3,\"mm\")), colour = gray(1/2))\nzp1 <- zp1 + scale_x_continuous(\"Quantity\", expand = c(0, 0),  # Clean up axis\n                                breaks = intersections$x,\n                                labels = expression(Q[1], Q[2]))\nzp1 <- zp1 + scale_y_continuous(\"Price\", expand = c(0, 0),  # Clean up axis\n                                breaks = intersections$y,\n                                labels = expression(P[1], P[2]))\nzp1 <- zp1 + theme_classic()  # New in ggplot2 0.9.3. Time to update!\nzp1 <- zp1 + coord_equal()  # Force fixed x-y relationship\nzp1 <- zp1 + ggtitle(\"A rightward shift in the demand curve\")  # Title\nprint(zp1)\n",
    "created" : 1501054311200.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "935099741",
    "id" : "53BAAE82",
    "lastKnownWriteTime" : 1501054317,
    "last_content_update" : 1501054317990,
    "path" : "~/GitHub/supplydemandcharts/R/charts.R",
    "project_path" : "R/charts.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}